# TimescaleDB Core Configuration
shared_preload_libraries = 'timescaledb'
timescaledb.max_background_workers = 8  # Increased from 3
timescaledb.telemetry_level = 'off'  # Disable telemetry

# Memory Settings
work_mem = 1GB                      # Increased from 128MB
maintenance_work_mem = 2GB          # Increased from 256MB
shared_buffers = 8GB                # Increased from 512MB
effective_cache_size = 24GB         # Increased from 1GB
wal_buffers = 256MB                 # Increased from 16MB

# Worker Processes
max_worker_processes = 32           # Increased from 16
max_parallel_workers = 16           # Increased from 4
max_parallel_workers_per_gather = 8 # Increased from 4

# Connection Settings
max_connections = 200               # Increased from 100
listen_addresses = '*'

# WAL and Checkpoint Settings
max_wal_size = 16GB                 # Increased from 1GB
min_wal_size = 4GB                  # Added
checkpoint_timeout = '30min'        # Increased from 15min
checkpoint_completion_target = 0.9
synchronous_commit = 'off'          # Added for performance

# Query Execution
statement_timeout = '120min'        # Increased from 60min
max_locks_per_transaction = 256     # Increased from 128
random_page_cost = 1.1              # Unchanged

# Autovacuum Settings (Added Section)
autovacuum = on
autovacuum_max_workers = 6
autovacuum_naptime = '10min'
autovacuum_vacuum_threshold = 1000
autovacuum_analyze_threshold = 500
autovacuum_vacuum_scale_factor = 0.05
autovacuum_analyze_scale_factor = 0.025

# TimescaleDB Query Optimization (Added Section)
timescaledb.max_open_chunks_per_insert = 1000
enable_partitionwise_aggregate = on
jit = on
jit_above_cost = 100000
jit_inline_above_cost = 150000
jit_optimize_above_cost = 350000

# Advanced Optimizations (Added Section)
vacuum_cost_delay = 2ms
vacuum_cost_limit = 2000
bgwriter_delay = 20ms
bgwriter_lru_maxpages = 1000
track_io_timing = on
default_statistics_target = 500
